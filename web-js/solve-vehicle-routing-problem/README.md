#Solve Vehicle Routing Problem

##About
This sample shows how to use the Geoprocessor class to send a request to Vehicle Routing Problem service. This sample is quite simple on purpose. There are many, many options that can be used when sending requests to the Vehicle Routing Problem service. You can [read about those options here](http://resources.arcgis.com/en/help/arcgis-rest-api/#/Vehicle_Routing_Problem_service/02r3000000n4000000/). In this sample one route is created moving from the starting depot to two delivery locations before returing to the depot.

[Live Sample](https://nhaney90.github.io/solve-vehicle-routing-problem/index.html)

##Usage notes
The Vehicle Routing Problem service costs credits to use of course. Once the user clicks on the "Submit Job" operation the IdentityManager prompts the user to enter their ArcGIS Online credentials. Once these credentials have been received and a token successfully generated the application then sends the request to the service. The directions for the route are displayed in the panel on the right. Also note that all times should be send to the service in UTC Epoch time (in milliseconds, not seconds!). The various outputs generated by the service are written to folders on the server and are not returned to the application once the processing has completed. This means you will need to send requests to retreive the data.

##How it works:
The following snippets highlight the important portions of the code.

Check to see if a token has been generated for the service. If not the user is prompted to sign in:
```javascript
if(serviceToken) {
	submitJob();
}
//if a token has not be generated, launch the signin box and create a token
else {
	var credential = esriId.getCredential(geoprocessorURL,{
		error:null,
		oAuthPopupConfirmation: true,
		retry:false,
		token:null
	});
}
```
Check to see if the geoprocessor is instantiated. If not create a new one with the token appended to the url. An object to contain the routing information and submit the job.
```javascript
if(!gp) {
	gp = new Geoprocessor(geoprocessorURL + "?token=" + serviceToken);
}
var params = {
	"default_date": 1455609600000,
	"time_units": "Hours",
	"distance_units": "Miles",
	"depots": '{"features":[{"geometry":{"x":'+ stops["Home"].x +',"y":'+ stops["Home"].y +'},"attributes":{"Name": "Home"}}]}',
	"orders": '{"features":[{"geometry":{"x":'+ stops["Destination1"].x +',"y":'+ stops["Destination1"].y +'},"attributes":{"Name": "Destination1"}},{"geometry":{"x":'+ stops["Destination2"].x +',"y":'+ stops["Destination2"].y +'},"attributes":{"Name": "Destination2"}}]}',
	"routes": '{"features":[{"attributes":{"Name":"vehicle_one","StartDepotName": "Home","EndDepotName":"Home","EarliestStartTime":1455609600000,"LatestStartTime":1455609600000}}]}',
	"populate_directions":true
};
gp.submitJob(params, processingComplete, null, executeFailed);
```
Use the geoprocessor's getResultData method to retrieve the output from the server
```javascript
gp.getResultData(results.jobId, "out_routes", showRoutes);
gp.getResultData(results.jobId, "out_stops", showStops);
gp.getResultData(results.jobId, "out_directions", showDirections);
```
